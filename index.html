<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <title>Think!EHR Rest Example</title>

    <!-- jQuery 3.2.1 -->
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.2.1.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
</head>
<body>

<h2 id="ehrid">EHRID: </h2>

<table class="table">
    <thead>
    <tr>
        <th class="col-xs-1 col-sm-1 col-md-1 col-lg-1">Temperature [Â°C]</th>
        <th class="col-xs-1 col-sm-1 col-md-1 col-lg-1">Systolic [mm[Hg]]</th>
        <th class="col-xs-1 col-sm-1 col-md-1 col-lg-1">Diastolic [mm[Hg]]</th>
        <th class="col-xs-1 col-sm-1 col-md-1 col-lg-1">Weight [kg]</th>
        <th class="col-xs-1 col-sm-1 col-md-1 col-lg-1">Pulse [/min]</th>
    </tr>
    </thead>
    <tbody>
    <tr>
        <th class="col-xs-1 col-sm-1 col-md-1 col-lg-1" id="temperature_result" ></th>
        <td class="col-xs-1 col-sm-1 col-md-1 col-lg-1" id="blood_pressure_result_systolic"></td>
        <td class="col-xs-1 col-sm-1 col-md-1 col-lg-1" id="blood_pressure_result_diastolic"></td>
        <td class="col-xs-1 col-sm-1 col-md-1 col-lg-1" id="weight_result"></td>
        <td class="col-xs-1 col-sm-1 col-md-1 col-lg-1" id="pulse_result"></td>
    </tr>
    </tbody>
</table>

</body>
</html>


<script>
    var url = 'https://ql-demo.marand.si/data?size=15';

    /**
     * Get page form url
     *
     * @param url
     * @returns {string}
     * @constructor
     */
    function Get(url){
        var Httpreq = new XMLHttpRequest(); // a new request
        Httpreq.open("GET", url, false);
        Httpreq.send(null);
        return Httpreq.responseText;
    }

    var json_obj = JSON.parse(Get(url));
    //console.log("this is the author name: "+json_obj);

//    /*
//    var i;
//    for (i = 0; i < 4; ++i) {
//
//        /* UPPER PRESSURE value 140*/
//        var  upper_pressure_value = json_obj.hits[i]._source.qcl_json_data.records[0].systolic.value;
//        /* UPPER PRESSURE unit  mm(hg)*/
//        var upper_pressure_unit = json_obj.hits[i]._source.qcl_json_data.records[0].systolic.unit;
//
//        /* DIASTOLIC value 80*/
//        var diastolic_value = json_obj.hits[i]._source.qcl_json_data.records[0].diastolic.value;
//        /* DIASTOLIC unit mm(hg)*/
//        var diastolic_unit = json_obj.hits[i]._source.qcl_json_data.records[0].diastolic.unit;
//
//        /* MIDDLE PRESSURE value 100*/
//        var pressure_middle_value = json_obj.hits[i]._source.qcl_json_data.records[0].meanArterialPressure.value;
//        /* MIDDLE PRESSURE unit mm(hg) */
//        var pressure_middle_unit = json_obj.hits[i]._source.qcl_json_data.records[0].meanArterialPressure.unit;
//
//        /* WEIGHT*/
//        var weight_value = json_obj.hits[i]._source.qcl_json_data.records[0].weight.value;
//        ///97.7
//        var weight_unit = json_obj.hits[i]._source.qcl_json_data.records[0].weight.unit;
//        ///kg
//
//        var temperature_body_value =json_obj.hits[i]._source.qcl_json_data.records[0].temperatureBody.value;
//        // 34.6 body temperature
//        var temperature_body_init = json_obj.hits[i]._source.qcl_json_data.records[0].temperatureBody.unit;
//        // cel
//        var temperature_ambient_value = json_obj.hits[i]._source.qcl_json_data.records[0].temperatureAmbient.value;
//        // 25.3 pace temperature
//        var temperature_ambient_unit = json_obj.hits[i]._source.qcl_json_data.records[0].temperatureAmbient.unit;
//        // cel
//
//        var pulse_rate_value = json_obj.hits[i]._source.qcl_json_data.records[0].pulseRate.value;
//        ///48
//        var pulse_rate_unit = json_obj.hits[i]._source.qcl_json_data.records[0].pulseRate.unit;
//        // bpm
//    }
//    */

    var ehrId = "50e1f335-9f17-4d0e-8a2c-c396cb3869a9";
    var baseUrl = 'https://rest.ehrscape.com/rest/v1';
    var queryUrl = baseUrl + '/query';
    var username = 'medrock2017';
    var password = 'medrock2017';
    var authorization = "Basic " + btoa(username + ":" + password);

    /* EHRID */
    $("#ehrid").append( ehrId );

    /* TEMPERATURE */
    $.ajax({
        url: baseUrl + "/view/" + ehrId + "/body_temperature",
        type: 'GET',
        headers: {
            "Authorization": authorization
        },
        success: function (res) {
            $("#temperature").append("Body Temperatures");
            for (var i in res) {
                $("#temperature_result").append(/*res[i].time + ': ' +*/ res[i].temperature +  "<br>");
                console.log(res[i].temperature);
            }
        }
    });


    /* BLOOD */
    $.ajax({
        url: baseUrl + "/view/" + ehrId + "/blood_pressure",
        type: 'GET',
        headers: {
            "Authorization": authorization
        },
        success: function (res) {
            $("#blood_pressure").append("Blood pressure");
            for (var i in res) {
                $("#blood_pressure_result_systolic").append( res[i].systolic  + "<br>");
                $("#blood_pressure_result_diastolic").append(res[i].diastolic + "<br>");
            }
        }
    });

    /* WEIGHT */
    $.ajax({
        url: baseUrl + "/view/" + ehrId + "/weight",
        type: 'GET',
        headers: {
            "Authorization": authorization
        },
        success: function (res) {
            $("#weight").append("Weight");
            for (var i in res) {
                $("#weight_result").append(res[i].weight + "<br>");
            }
        }
    });

    /* PULSE */
    $.ajax({
        url: baseUrl + "/view/" + ehrId + "/pulse",
        type: 'GET',
        headers: {
            "Authorization": authorization
        },
        success: function (res) {
            $("#pulse").append("Pulse");
            for (var i in res) {
                $("#pulse_result").append(res[i].pulse + "<br>");
            }
        }
    });



    /* CHAT BOOT */
    var headID = document.getElementsByTagName("head")[0];
    var newCss = document.createElement('link');
    newCss.rel = 'stylesheet';
    newCss.type = 'text/css';
    window._botUsername = '630143';
    window._botName = 'WarnADoc';
    newCss.href = "http://rebot.me/assets/css/bot.css";
    var newScript = document.createElement('script');
    newScript.src = "http://rebot.me/assets/js/bot.js";
    newScript.type = 'text/javascript';
    headID.appendChild(newScript);
    headID.appendChild(newCss);

</script>